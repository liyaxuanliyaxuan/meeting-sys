{"version":3,"sources":["components/forms/Input/Input.tsx","services/apis/item.ts","components/forms/Input/Input.module.scss","services/apis/files.ts","components/forms/UploadInput/UploadInput.module.scss","components/commons/File/style.module.scss","../node_modules/@ant-design/icons-svg/es/asn/DownloadOutlined.js","../node_modules/@ant-design/icons/es/icons/DownloadOutlined.js","../node_modules/@ant-design/icons-svg/es/asn/CloseOutlined.js","../node_modules/@ant-design/icons/es/icons/CloseOutlined.js","components/forms/UploadInput/UploadInput.tsx","components/commons/File/index.tsx"],"names":["Input","props","type","name","placeholder","bind","msg","warn","readOnly","update","value","hasBtn","btnValue","btnCallback","btnStatus","dateCallback","onFocus","onBlur","onInput","useState","isShowPwd","setIsShowPwd","isReadOnly","setIsReadOnly","toggleShowPwd","className","style","container","label","input","onChange","bindEvent","eye","onClick","disabled","btn","publishItem","meetingJson","taskJson","guestJson","post","config","data","encodeURIComponent","JSON","stringify","getHomeItemList","offset","limit","get","params","getItemTypes","getItemCount","getHomeItemListByCondition","getItemInfo","meetingId","applyItem","favoriteItem","quitItem","quitFavorite","getUserRelatedItem","module","exports","uploadFiles","formData","downloadFile","fileName","responseType","deleteMyFile","fileId","deleteFile","DownloadOutlined","ref","React","createElement","AntdIcon","Object","assign","icon","DownloadOutlinedSvg","displayName","forwardRef","CloseOutlined","CloseOutlinedSvg","UploadInput","uploadStatus","needUpload","loadStatus","isLoadSucess","defaultFileList","uploadFile","refresh","handleChange","e","a","preventDefault","file","FormData","append","target","files","String","uploadContainer","upload","fileList","map","item","key","uid","tt","color","success","actionBar","title","File","relationType","useParams","_meetingId","Number","roleType","setRoleType","setFileStatus","location","useLocation","useImmer","mName","startTime","closeTime","introduction","organizer","communicate","schedule","isFavorited","isApplied","info","setInfo","meetingInfoR","useRequest","onSuccess","result","meeting","relations","state","created","draft","typeid","needvolunteer","fileid","meetingid","uploadFileR","manual","download","console","log","code","message","deleteMyFileR","onError","error","spinning","loading","header","meetingIcon","run","meetinfId","download2"],"mappings":"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","file":"static/js/23.709549d9.chunk.js","sourcesContent":["/**\r\n * @ Author: zao\r\n * @ Create Time: 2020-03-20\r\n * @ Modified by: zao\r\n * @ Description: 全局input，仅包含text和password，配合useOnChange使用\r\n */\r\n\r\nimport React, {\r\n  ReactElement,\r\n  useState,\r\n} from 'react';\r\n\r\nimport {\r\n  EyeInvisibleOutlined,\r\n  EyeOutlined,\r\n} from '@ant-design/icons';\r\nimport { DatePicker } from 'antd'\r\n\r\nimport style from './Input.module.scss';\r\n\r\ninterface Props {\r\n  type: 'text' | 'password' | 'Date';\r\n  name: string; // input框前面的文字\r\n  placeholder?: string;\r\n  msg?: string;  // input下方的提示语\r\n  warn?: boolean; // input msg的警告\r\n  bind?: {\r\n    bindEvent: {\r\n      onChange: (e: React.SyntheticEvent) => any;\r\n      value: string;\r\n    }\r\n  }; // 双向绑定input事件\r\n  className?: string;\r\n  readOnly?: boolean;\r\n  value?: string;\r\n  update?: boolean;\r\n  hasBtn?: boolean;\r\n  btnValue?: string;\r\n  btnStatus?: boolean;\r\n  btnCallback?: (e: React.SyntheticEvent) => any;\r\n  dateCallback?: (...params: any) => any;\r\n  onFocus?: (e: React.SyntheticEvent) => any;\r\n  onBlur?: (e: React.SyntheticEvent) => any;\r\n  onInput?: (e: React.SyntheticEvent) => any;\r\n}\r\n\r\nfunction Input(props: Props): ReactElement {\r\n  const {\r\n    type,\r\n    name,\r\n    placeholder = '点击编辑内容',\r\n    bind,\r\n    msg,\r\n    warn = false,\r\n    readOnly = false,\r\n    update = false,\r\n    value,\r\n    hasBtn = false,\r\n    btnValue = '',\r\n    btnCallback,\r\n    btnStatus = false,\r\n    dateCallback,\r\n    onFocus,\r\n    onBlur,\r\n    onInput\r\n  } = props\r\n  const [isShowPwd, setIsShowPwd] = useState(false)\r\n  const [isReadOnly, setIsReadOnly] = useState(readOnly)\r\n  const toggleShowPwd = () => {\r\n    setIsShowPwd(!isShowPwd)\r\n  }\r\n  return (\r\n    <div className={`${style.container} ${props.className}`}>\r\n      <label className={style.label}>\r\n        <span className={style.name}>{name}</span>\r\n        {type === 'Date' ? <DatePicker className={style.input} placeholder='选择日期' onChange={dateCallback}/> :\r\n          <input\r\n            className={style.input}\r\n            type={!(type === 'password') ?\r\n              type\r\n              :\r\n              isShowPwd ?\r\n                'text' : 'password'\r\n            }\r\n            placeholder={placeholder}\r\n            readOnly={isReadOnly}\r\n            value={value || ''}\r\n            {...bind?.bindEvent}\r\n            onFocus={onFocus}\r\n            onBlur={onBlur}\r\n            onInput={onInput}\r\n          />}\r\n        {type === 'password' ?\r\n          isShowPwd ?\r\n            <EyeOutlined className={style.eye} onClick={toggleShowPwd} />\r\n            :\r\n            <EyeInvisibleOutlined className={style.eye} onClick={toggleShowPwd} />\r\n          :\r\n          null}\r\n        {hasBtn ? (<button\r\n          className={btnStatus ? style.disabled : style.btn}\r\n          disabled={btnStatus}\r\n          onClick={btnCallback}>{btnValue}</button>) : null}\r\n        {update ? (<span className={style.update} onClick={() => setIsReadOnly(false)}>修改</span>) : null}\r\n      </label>\r\n\r\n\r\n      <span className={warn ? style.warn : style.msg}>{msg}</span>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Input\r\n","/**\r\n * @ Author: zao\r\n * @ Create Time: 2020-08-20 18:49:22\r\n * @ Modified by: zao\r\n * @ Description: 关于会议相关接口\r\n */\r\n\r\nimport * as config from './config'\r\nimport { get, post } from '../axios'\r\n\r\nexport interface Iitem {\r\n  meetingid?: number;\r\n  mName?: string;\r\n  location?: string;\r\n  startTime?: string;\r\n  closeTime?: string;\r\n  introduction?: string;\r\n  schedule?: string;\r\n  needvolunteer?: string;\r\n  typeid?: number;\r\n  organizer?: string;\r\n  hostedby?: string;\r\n  communicate?: string;\r\n}\r\n\r\nexport interface Itask{\r\n  taskinfo?: string;\r\n  workingtime?: string;\r\n  numbers?: string;\r\n}\r\n\r\nexport interface Iguest{\r\n  introduction?: string;\r\n  name?: string;\r\n  ico?: any;\r\n}\r\n\r\n\r\n\r\n/**\r\n * 发布会议\r\n * @param meeting 会议json\r\n * @param volunt 志愿者json\r\n * @param guests 嘉宾json\r\n */\r\nexport const publishItem = (meetingJson: Iitem, taskJson: Itask[] = [], guestJson:Iguest= {}) => post(config.ADD_MEETING_INFO,\r\n  {\r\n    data: {\r\n      meetingJson: encodeURIComponent(JSON.stringify(meetingJson)),\r\n      taskJson: encodeURIComponent(JSON.stringify(taskJson)),\r\n      guestJson: encodeURIComponent(JSON.stringify(guestJson))\r\n    }, msg: '发布成功'\r\n  })\r\n\r\nexport const addGuest = (meetingId: string, introduction: string, name: string, ico: any) => post(config.ADD_GUEST, {\r\n  data: {\r\n    meetingId,\r\n    introduction,\r\n    name,\r\n    ico\r\n    }\r\n  })\r\n\r\n/**\r\n * 获取主页会议列表\r\n * @param offset 起始位置\r\n * @param limit 条数\r\n * @returns \r\n */\r\nexport const getHomeItemList = (offset: number, limit: number) => {\r\n  return get(\r\n    config._GET_MEETING_HOME_PAGE_DATA,\r\n    { params: { offset, limit } })\r\n}\r\n\r\n/**\r\n * 获取会议主题图\r\n * @param meetingId 会议id\r\n */\r\nexport const getItemIcon = (meetingId: number) => {\r\n  return get(config._GET_MEETING_ICON + meetingId)\r\n}\r\n\r\n/**\r\n * \r\n * @param meetingId 会议id\r\n * @param icon file文件\r\n */\r\nexport const uploadItemIcon = (meetingId: number, icon: any) => {\r\n  return post(config.UPLOAD_MEETING_ICON + meetingId,\r\n    { data: icon }, true)\r\n}\r\n\r\n/**\r\n * 获取会议类型\r\n */\r\nexport const getItemTypes = () => get(config._GET_MEETING_TYPE)\r\n\r\n/**\r\n * 获取会议总数\r\n */\r\nexport const getItemCount=()=>post(config.MEETING_COUNT)\r\n\r\n/**\r\n * 根据会议类型获得列表\r\n * @param type 会议类型\r\n */\r\nexport const getHomeItemListByCondition = (type?: number) => get(config._SEARCH_MEETING_CONDITION, { params: { type } })\r\n\r\n/**\r\n * 获得会议详情\r\n * @param meetingId 会议id\r\n * 嘉宾列表信息\r\n */\r\nexport const getItemInfo = (meetingId: number) => get(config._GET_MEETING_INFO + meetingId)\r\n\r\n/**\r\n * 获取与自己相关的会议信息\r\n * @param type 路径变量中类型：（1为创建 2为参加 3为收藏）\r\n */\r\nexport const getMyItem = (type: number) => get(config.FAVORITE_MEETING)\r\n\r\n/**\r\n * 参加会议\r\n * @param meetingId 会议id\r\n */\r\nexport const applyItem = (meetingId: number) => post(config.ATTEND_MEETING, { data: { meetingId }, msg: '报名成功' })\r\n\r\n/**\r\n * 收藏会议\r\n * @param meetingId 会议id\r\n */\r\nexport const favoriteItem = (meetingId: number) => post(config.FAVORITE_MEETING, { data: { meetingId }, msg: '收藏成功' })\r\n\r\n/**\r\n * 退出会议\r\n * @param meetingId \r\n */\r\nexport const quitItem = (meetingId: number) => post(config.QUIT_MEETING +2+'/'+ meetingId,{ msg: '取消成功' })\r\n\r\n/**\r\n * 取消收藏会议\r\n * @param meetingId\r\n */\r\nexport const quitFavorite = (meetingId: number) => post(config.QUIT_MEETING +3+'/'+meetingId, {  msg: '取消成功' })\r\n\r\n/**\r\n * 获取与自己相关的会议\r\n * @param type 1为创建,2为参加,3为收藏，5志愿者\r\n */\r\nexport const getUserRelatedItem = (type: number) => get(config._GET_USER_RELATED_MEET + type)\r\n\r\n/**\r\n * 获取会议被参加、收藏的次数\r\n * @param meetingId\r\n * @param （2为参加 3为收藏）\r\n */\r\nexport const getRelatedCount = (meetingId: number, type: number) => get(config._GET_MEETING_STATUS_COUNT + type, { params: { meetingId } })\r\n\r\n/**\r\n * 获取自己会议 被参加、收藏、申请志愿者的详细信息\r\n * @param meetingId \r\n * @param type （2为参加 3为收藏）\r\n */\r\nexport const getRelatedInfo = (meetingId: number, type: number) => get(config._GET_USER_CREATED_MEET_INFO + type, { params: { meetingId } })","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Input_container__wKzPG\",\"label\":\"Input_label__lxk5D\",\"name\":\"Input_name__1SI8b\",\"input\":\"Input_input__1zsc-\",\"btn\":\"Input_btn__1N2g4\",\"disabled\":\"Input_disabled__10Lvh\",\"eye\":\"Input_eye__3OG8N\",\"msg\":\"Input_msg__2RtKO\",\"warn\":\"Input_warn__3bvyY\",\"update\":\"Input_update__Tkcme\"};","/**\r\n * @ Author: zao\r\n * @ Create Time: 2020-08-20 18:49:22\r\n * @ Modified by: zao\r\n * @ Description: 关于文件相关接口\r\n */\r\n\r\nimport * as config from './config'\r\nimport { get, post,deleteFile } from '../axios'\r\n\r\n/**\r\n * 上传文件\r\n * @param formData {file,meetingId} \r\n */\r\nexport const uploadFiles = (formData: any) => post(config.UPLOAD_FILE, { data: formData }, true)\r\n\r\n\r\n/**\r\n * 下载文件\r\n * @param meetingId \r\n * @param fileName \r\n */\r\nexport const downloadFile = (meetingId: number, fileName: string) => get(\r\n  config._DOWNLOAD_FILE,\r\n  {\r\n    params: { meetingId, fileName },\r\n    responseType: 'blob'\r\n  }\r\n)\r\n\r\n\r\n/**\r\n * 删除文件\r\n * @param meetingId \r\n * @param fileId \r\n */\r\nexport const deleteMyFile=(meetingId:number,fileId:number)=>deleteFile(config.d_DELETE_MEETING_FILE,{data:{meetingId,fileId}})\r\n\r\n/**\r\n * 获取下载列表\r\n * @param meetingId \r\n */\r\nexport const getFileList=(meetingId:number)=>get(config._GET_FILE_LIST,{params:{meetingId}})\r\n\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"UploadInput_container__L5-ZV\",\"upload\":\"UploadInput_upload__KOsnt\",\"input\":\"UploadInput_input__1LiRE\",\"fileList\":\"UploadInput_fileList__2cIed\",\"color\":\"UploadInput_color__3eLeX\",\"tt\":\"UploadInput_tt__2x4s_\",\"actionBar\":\"UploadInput_actionBar__2Belz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"style_container__30BK8\",\"header\":\"style_header__2yw6N\",\"title\":\"style_title__3eGtm\",\"meetingIcon\":\"style_meetingIcon__2yQCk\",\"info\":\"style_info__qMxEU\",\"btn\":\"style_btn__2YIGj\",\"star\":\"style_star__2ECpQ\",\"starFiled\":\"style_starFiled__3zC0g\",\"fileList\":\"style_fileList__p0n4Q\"};","// This icon file is generated automatically.\n// tslint:disable\nvar DownloadOutlined = { \"name\": \"download\", \"theme\": \"outlined\", \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z\" } }] } };\nexport default DownloadOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport React from 'react';\nimport DownloadOutlinedSvg from \"@ant-design/icons-svg/es/asn/DownloadOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar DownloadOutlined = function DownloadOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: DownloadOutlinedSvg\n  }));\n};\n\nDownloadOutlined.displayName = 'DownloadOutlined';\nexport default React.forwardRef(DownloadOutlined);","// This icon file is generated automatically.\n// tslint:disable\nvar CloseOutlined = { \"name\": \"close\", \"theme\": \"outlined\", \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z\" } }] } };\nexport default CloseOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport React from 'react';\nimport CloseOutlinedSvg from \"@ant-design/icons-svg/es/asn/CloseOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar CloseOutlined = function CloseOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: CloseOutlinedSvg\n  }));\n};\n\nCloseOutlined.displayName = 'CloseOutlined';\nexport default React.forwardRef(CloseOutlined);","/**\r\n * @ Author: zao\r\n * @ Create Time: 2020-03-23\r\n * @ Modified by: zao\r\n * @ Description: 封装的antd的上传文件组件\r\n */\r\n\r\nimport React, {\r\n  ReactElement,\r\n  useState,\r\n  FormEvent,\r\n} from 'react';\r\n\r\nimport { CloseOutlined, DownloadOutlined } from '@ant-design/icons'\r\n\r\nimport style from './UploadInput.module.scss';\r\n\r\ninterface Ifile {\r\n  uid?: string;      // 文件唯一标识，建议设置为负数，防止和内部产生的 id 冲突\r\n  name?: string;   // 文件名\r\n  meetingId?: string;\r\n  status?: 'uploading|error|done|removed'; // 状态有：uploading done error removed\r\n  response?: any, // 服务端响应内容\r\n}\r\n\r\ninterface Props{\r\n  className?: string;\r\n  name?: string;\r\n  needUpload?: boolean;\r\n  defaultFileList?: Ifile[];\r\n  loadStatus?: boolean;\r\n  isLoadSucess?: boolean;\r\n  meetingId?: number;\r\n  refresh?: () => any;\r\n  uploadFile?: (...params: any) => any;\r\n  deleteFile?: (...params: any) => any;\r\n  downloadFile?: (...params: any) => any;\r\n}\r\n// \r\nfunction UploadInput({className, name, meetingId, needUpload = true, loadStatus = false, isLoadSucess = true, defaultFileList = [], uploadFile = () => { }, deleteFile = () => { }, downloadFile = () => { }, refresh = () => { } }: Props): ReactElement {\r\n  enum uploadStatus {\r\n    success = '#1890ff',\r\n    error = '#ff4d4f',\r\n    normal = '#000000'\r\n  }\r\n  const handleChange = async (e: any) => {\r\n    e.preventDefault()\r\n    if (needUpload) {\r\n      let file = new FormData()\r\n      file.append('file', e.target.files[0])\r\n      file.append('meetingId', String(meetingId))\r\n      await uploadFile(file)\r\n      if (isLoadSucess) {\r\n        refresh()\r\n      }\r\n    }\r\n  }\r\n  return (\r\n    <div className={`${className} ${style.container}`}>\r\n      {needUpload ? <label className={style.uploadContainer} onChange={handleChange}>\r\n        <input type='file' />\r\n        <div className={style.upload}>\r\n          <div className={style.input}>+添加附件</div>\r\n        </div>\r\n      </label> : <></>}\r\n\r\n\r\n      <ul className={style.fileList}>\r\n        {defaultFileList.map(item => {\r\n          return <li key={item.uid}>\r\n            <span className={style.tt} style={{ color: uploadStatus.success }}>{item.name}</span>\r\n            {needUpload ?\r\n              <div className={style.actionBar}>\r\n                <DownloadOutlined title='下载文件' onClick={() => downloadFile(item.meetingId, item.name)} />\r\n                <CloseOutlined title='删除文件' onClick={() => deleteFile(item.uid, item.meetingId)} />\r\n              </div> :\r\n              <div className={style.actionBar}>\r\n                <DownloadOutlined title='下载文件' onClick={() => downloadFile(item.meetingId, item.name)} />\r\n              </div>}\r\n          </li>\r\n        })}\r\n      </ul>\r\n\r\n    </div >\r\n  )\r\n}\r\n\r\nexport default UploadInput\r\n","/**\r\n * @ Author: zao\r\n * @ Create Time: 2020-08-20 18:49:22\r\n * @ Modified by: zao\r\n * @ Description: 文件上传组件\r\n */\r\n\r\n// TODO: remember to set request\r\n// TODO: remember to set UploadInput loadStatus\r\n\r\nimport React, {\r\n  FormEvent,\r\n  ReactElement,\r\n  useState\r\n} from 'react';\r\n\r\nimport { Spin, message } from 'antd';\r\nimport { useParams, useLocation } from 'react-router-dom';\r\nimport { useImmer } from 'use-immer';\r\n\r\nimport Input from '@/components/forms/Input/Input';\r\nimport Textarea from '@/components/forms/Textarea';\r\nimport UploadInput from '@/components/forms/UploadInput'\r\nimport {\r\n  getItemInfo,\r\n  Iitem,\r\n} from '@/services/apis/item';\r\nimport { uploadFiles, downloadFile, deleteMyFile } from '@/services/apis/files'\r\n\r\nimport {\r\n  useRequest,\r\n  useUnmount,\r\n} from '@umijs/hooks';\r\nimport { download,download2 } from '@/utils'\r\nimport style from './style.module.scss';\r\n\r\ninterface Props {\r\n  type: number;\r\n}\r\ninterface Iinfo extends Iitem {\r\n  isFavorited: boolean;\r\n  isApplied: boolean;\r\n  files: {\r\n    fileid: number;\r\n    meetingid: number;\r\n    path: string;\r\n    name: string;\r\n  }[]\r\n}\r\nfunction File({ type }: Props): ReactElement {\r\n  const { meetingId } = useParams()\r\n  const _meetingId = Number(meetingId)\r\n  const [roleType, setRoleType] = useState(0)\r\n  const [fileStatus, setFileStatus] = useState(false)\r\n  const location = useLocation()\r\n  const [info, setInfo] = useImmer<Iinfo>({\r\n    mName: '',\r\n    startTime: '',\r\n    closeTime: '',\r\n    introduction: '',\r\n    organizer: '',\r\n    communicate: '',\r\n    schedule: '',\r\n    isFavorited: false,\r\n    isApplied: false,\r\n    files: []\r\n  })\r\n\r\n  enum relationType {\r\n    created = 1,// 创建的会议\r\n    applied = 2,// 参加的会议\r\n    favorited = 3,// 收藏的会议\r\n  }\r\n  enum btnStatus {\r\n    applied = 'rgba(255,190,14,1)',// 已参加会议\r\n    unApplied = 'rgba(255,190,14,1)',// 未参加会议\r\n    appliedValue = '取消报名',\r\n    unAppliedValue = '我要报名'\r\n  }\r\n  const meetingInfoR = useRequest((meetingId = _meetingId) => getItemInfo(meetingId), {\r\n    onSuccess: (result, params) => {\r\n      if (result.data) {\r\n        const { relations, meeting, files } = result.data\r\n        // if (relations.includes(relationType.created)) {\r\n        //   setRoleType(relationType.created)\r\n        // } else {\r\n        //   setRoleType(0)\r\n        // }\r\n        if (location.state) {\r\n          setRoleType(relationType.created)\r\n        } else {\r\n          setRoleType(0)\r\n        }\r\n        setInfo(draft => {\r\n          draft.mName = meeting.mName\r\n          draft.location = meeting.location\r\n          draft.startTime = meeting.startTime\r\n          draft.closeTime = meeting.closeTime\r\n          draft.introduction = meeting.introduction\r\n          draft.organizer = meeting.organizer\r\n          draft.communicate = meeting.communicate\r\n          draft.schedule = meeting.schedule\r\n          draft.typeid = meeting.typeid\r\n          draft.needvolunteer = meeting.needvolunteer\r\n          draft.files = files.map((item: any) => {\r\n            return {\r\n              uid: item.fileid,\r\n              name: item.name,\r\n              meetingId: item.meetingid,\r\n            }\r\n          })\r\n        })\r\n      }\r\n    }\r\n  })\r\n\r\n\r\n  const downloadFileR = useRequest((meetingId, fileName) => downloadFile(meetingId, fileName), {\r\n    manual: true,\r\n    onSuccess: (result, params) => {\r\n      download(result, params[1])\r\n    },\r\n  })\r\n\r\n\r\n\r\n  const uploadFileR = useRequest((formData) => uploadFiles(formData), {\r\n    manual: true,\r\n    onSuccess: (result, params) => {\r\n      console.log(result)\r\n\r\n      if (result.code >= 0) {\r\n        setFileStatus(true)\r\n        message.success('上传成功')\r\n      } else {\r\n        setFileStatus(false)\r\n      }\r\n    }\r\n  })\r\n\r\n  const deleteMyFileR = useRequest((meetingId, fileId) => deleteMyFile(meetingId, fileId), {\r\n    manual: true,\r\n    onSuccess: (result, params) => {\r\n      if (result.data) {\r\n        setFileStatus(true)\r\n        message.success('删除成功')\r\n      } else {\r\n        setFileStatus(false)\r\n      }\r\n    },\r\n    onError: (error) => {\r\n      setFileStatus(false)\r\n    }\r\n  })\r\n\r\n\r\n  return (\r\n    <Spin spinning={meetingInfoR.loading}>\r\n      <div className={style.container}>\r\n        <div className={style.header}>\r\n          <div>\r\n            <h2 className={style.title}>{info.mName}</h2>\r\n            <div className={style.meetingIcon}></div>\r\n          </div>\r\n          <div className={style.info}>\r\n            <Input type='text' name={'开始时间'} readOnly value={info.startTime} />\r\n            <Input type='text' name={'结束时间'} readOnly value={info.closeTime} />\r\n            <Input type='text' name={'地点'} readOnly value={info.location} />\r\n          </div>\r\n\r\n        </div>\r\n        <UploadInput\r\n          className={style.fileList}\r\n          needUpload={roleType === relationType.created} defaultFileList={info.files}\r\n          loadStatus={false}\r\n          meetingId={_meetingId}\r\n          uploadFile={uploadFileR.run}\r\n          deleteFile={deleteMyFileR.run}\r\n          downloadFile={(meetinfId,fileName)=>download2(meetingId as string,fileName)}\r\n          refresh={meetingInfoR.refresh} />\r\n      </div>\r\n    </Spin>\r\n  )\r\n}\r\n\r\nexport default File\r\n\r\n\r\n"],"sourceRoot":""}